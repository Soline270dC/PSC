import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

dF = [0.9878962762077521, 1.0184030744461638, 0.9893577800205969, 1.0010911278709145, 1.0054551191160854]
On = [0.4017651595786583, 0.2932993355625525, 0.21133619888118088, 0.15470189282447444, 0.11443911646738462]
aO = 0.7527853540772447
kO = 0.27269888828937816

# x : taille de r, y : taille de g
dF2 = [[1.01376863676194, 1.0585014666286237, 1.137618238638196], 
       [1.0822421846644454, 0.999202843056521, 1.0764893812641003], 
       [1.1435086675660098, 1.0363983034792732, 1.0933423556006083]]
# dF ne dépend pas de la taille des données
On2 = [[0.4034376642241171, 0.2041080077925862, 0.1121964545604473], 
       [0.4023823257499898, 0.21385422192211564, 0.11356316721170392], 
       [0.40195542263405204, 0.2141382037528459, 0.11459011050488024]]
# ONND ne dépend pas beaucoup de la taille de r, seulement de celle de g

dW = [0.11695019464114537, 0.07519670169504668, 0.04635710783422618, 0.037635964369385266, 0.03513950257944235, 0.034915909588538824, 0.03551954525297166]
dW2 = [0.1075571458283337, 0.058154755812719755, 0.038184925077511866, 0.02224003690972062, 0.015346164251459939, 0.012656025755147153, 0.011701374134049793]
dW3 = [0.0987158745529338, 0.055551779125633, 0.028805074532751544, 0.01736431077894652, 0.010312295120659138, 0.006022595804483621, 0.004688093978896632]
aW = 0.21335538987433386
kW = 0.2611026697197249

n = 7
ndata = np.array([int(p) for p in np.logspace(1, 4, n)])

from math import exp, log
# plt.plot(np.linspace(10, 1000, 100), aO*np.power(np.linspace(10,1000,100), -kO), label = "a/|G|^k")
# plt.scatter(ndata, On, label = "ONND(R,G)", c = 'ForestGreen', marker = "X")
plt.plot(ndata, dW3)
plt.plot(ndata, dW2)
plt.xticks(ndata)
plt.legend()
# plt.plot(ndata, [aW*exp(-kW*log(size)) for size in ndata])
# plt.semilogx()

plt.xlabel("|G|")
plt.ylabel("dWasser(R,G)")
plt.show()
"""
ONND est proportionnel à 1/|G|^k
k = 0.27269888828937816

dWasser se stabilise à partir de |G| = 10^3 et |R| = 10^3

dWasser typique pour les conditions stables : 1
"""